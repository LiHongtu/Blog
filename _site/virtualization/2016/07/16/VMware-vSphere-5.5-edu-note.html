<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>观　堂Guan tang</title>
<meta name="description" content="生活、思考、感悟、记录、探索、分享.">
<link rel="stylesheet" href="/css/style.css">
<link rel="canonical" href="https://lihongtu.github.io/">
<link rel="alternate" type="application/rss+xml" title="观堂Guan tang" href="/feed.xml">
</head>
<body>
<header class="site-header" role="banner">
  <div class="wrapper"> <a class="site-title" href="/">观 堂Guan tang</a>
    <nav class="site-nav"> <span class="menu-icon">
      <svg viewBox="0 0 18 15" width="18px" height="15px">
        <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
        <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
        <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
      </svg>
      </span>
      <div class="trigger"> <a class="page-link" href="/about/">About</a> </div>
    </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
  <div class="wrapper"> <article class="post" >
  <header class="post-header">
    <h1 class="post-title" >VMware vSphere 5.5培训笔记</h1>
    <p class="post-meta">
      <time datetime="2016-07-16T13:52:59+08:00" itemprop="datePublished">Jul 16, 2016</time>
      </p>
  </header>
  <div class="article-entry" itemprop="articleBody"> <h1 id="第一章-课程简介">第一章 课程简介</h1>
<h2 id="1课程要求">1、课程要求</h2>

<p>上课时间80%</p>

<p>教材涵盖内容不全，需要看相关文档（白皮书）</p>

<h2 id="2什么是vsphere">2、什么是Vsphere</h2>

<p>Vsphere是基础架构管理套件</p>

<h3 id="管理">管理</h3>

<p>管理计算、存储、网络</p>

<p>Vsphere client 直接操作</p>

<p>Vsphere web client</p>

<h3 id="vmotion">vmotion</h3>

<p>在线迁移</p>

<p>内存迁移、存储迁移、虚机迁移</p>

<p>无共享存储迁移    迁移主机和存储</p>

<h2 id="3vcp认证">3、VCP认证</h2>
<h3 id="vcap-高级认证">VCAP 高级认证</h3>
<p>	-dcpa管理方向</p>

<p>	-DCD 设计方向，架构方向</p>

<h3 id="vcdx">Vcdx</h3>

<p>国内不考
国外论文、答辩</p>

<h1 id="第二章-虚拟化">第二章 虚拟化</h1>
<h2 id="1虚拟化简介">1、虚拟化简介</h2>
<p>在物理的平台上安装虚拟化平台软件vsphere，在虚拟化平台之上创建虚拟机。</p>
<h4 id="为什么使用虚拟机">为什么使用虚拟机</h4>
<p>资源利用率低</p>

<p>管理不灵活</p>

<p>成本高</p>

<h3 id="资源池化">资源池化</h3>
<p>把资源做成一个资源池</p>

<p>虚拟机在管理员角度是一个文件夹</p>

<p>虚拟机，仅仅为逻辑上的计算机。</p>

<h3 id="cpu虚拟化">CPU虚拟化</h3>
<p>调度原理</p>

<p>物理快空闲占用</p>

<p>虚拟CPU没有时间，必须通过占用物理cpu时间获得cpu时间。</p>

<p>物理空闲，虚拟过来调用</p>

<p>cpu就绪时间</p>

<p>40ms  大于40ms就有问题</p>

<p>一个cpu创建3-5个虚拟cpu比较合理</p>

<h3 id="内存虚拟化">内存虚拟化</h3>
<p>按需分配</p>

<p>资源充分利用</p>

<p>给你了，你不用我拿过来用</p>

<h3 id="网络虚拟化">网络虚拟化</h3>
<h3 id="存储虚拟化">存储虚拟化</h3>
<p>Datastore 容器  逻辑单元，把物理设备加进来，自动创建逻辑文件</p>
<h2 id="2esxi概述">2、ESXI概述</h2>
<h3 id="虚拟主机">虚拟主机</h3>
<p>ESXi 作为 NTP 客户端
同步时间准确性</p>
<h2 id="3vsphere-client">3、Vsphere client</h2>
<p>Vsphere client5.1开始功能不升级</p>

<p>建议使用web client</p>

<h3 id="备注">备注</h3>
<p>管理主机不用Root</p>

<p>Vpxuger管理主机，是主机和vcenter协商出来的密钥。</p>

<h1 id="实验1--安装vsphere-client-和-vsphere-web-client">实验1  安装vSphere Client 和 vSphere Web Client</h1>
<h2 id="实验环境">实验环境</h2>
<p>第一步，
https://182.48.114.3/
组别：20B</p>

<p>Vmware55
abcd1234</p>
<h1 id="实验2--配置esxi主机">实验2  配置ESXI主机</h1>

<h1 id="第三章-创建虚拟机">第三章 创建虚拟机</h1>
<h2 id="1虚机概念">1、虚机概念</h2>

<p>虚拟机，从内部看，是一对硬件；从EXSi主机看，是一组文件集。</p>

<h3 id="模板文件">模板文件</h3>

<p>模板文件不能开机</p>

<h3 id="磁盘文件">磁盘文件</h3>
<p>磁盘描述文件、磁盘数据文件是成对出现</p>

<h3 id="vmdk-快照">Vmdk 快照</h3>
<p>快照原理</p>

<p>描述、数据为只读，增量使用</p>

<p>两块盘加在一起是当前数据</p>

<p>快照不能备份，每个快照为一个增量</p>

<p>目的为回滚到目前状态</p>

<p>快照坏了，依赖它的不能使用。</p>

<h3 id="虚机">虚机</h3>
<p>虚机可以挂起，相当于虚机关机。</p>

<p>和关机的区别：内存状态保存在vmss</p>

<h3 id="交换文件">交换文件</h3>
<p>操作系统交换文件为虚机自己管理，虚机开机时创建</p>

<p>缺省为内存大小</p>

<h2 id="2创建虚机">2、创建虚机</h2>
<h4 id="三种方法">三种方法</h4>
<p>使用向导</p>

<p>克隆</p>

<p>模板部署</p>

<h3 id="虚机配置">虚机配置</h3>
<p>精简</p>

<p>密集</p>

<p>当主机内存需要时候，虚机内存释放给主机</p>

<h1 id="实验3-创建虚机">实验3 创建虚机</h1>
<p>•	Provisioned Storage <strong><em>2.58GB</em></strong> 
•	Not Shared Storage <strong>1.85KB</strong>__ 
•	Used Storage <strong>__1.85KB</strong>
配置过后：
“•	Provisioned Storage <strong><em>2.48GB</em></strong> 
•	Not Shared Storage <strong>1.04GB</strong>__ 
•	Used Storage ____1.04GB __</p>
<h1 id="第四章-vmware-vcenter-server">第四章 VMware vCenter Server</h1>
<h2 id="1vcenter-server体系机构">1、vCenter Server体系机构</h2>
<h3 id="管理平台">管理平台</h3>
<p>管理主机、虚机、设置功能</p>

<p>每个vcenter server实例可以管理一个1kESXi主机，1w台虚机。</p>

<p>内置Linux数据库  vhost</p>

<p>内置windows平台数据库    sql server2008 r2</p>

<h2 id="2部署-vcenter-server-虚拟设备">2、部署 vCenter Server 虚拟设备</h2>
<p>导入设备</p>

<p>导入VOF模板</p>

<p>封装系统、组件。</p>

<h1 id="试验4">试验4</h1>

<h2 id="3管理-vcenter-server-清单">3、管理 vCenter Server 清单</h2>
<h3 id="使用文件夹组织清单对象">使用文件夹组织清单对象</h3>

<h1 id="补充-vsphere-6">补充 Vsphere 6</h1>
<p>Vsphere6把vcentre分成两大块</p>

<p>vsphere5是服务</p>

<h1 id="实验5--vcenter-server-清单操作">实验5  vCenter Server 清单操作</h1>
<p>注意事项</p>

<p>做实验时，这章ha  dns  注意：两人一起做还是</p>

<p>Pin、unpin实现展开于收缩</p>

<h1 id="第五章-配置和管理虚拟网络">第五章 配置和管理虚拟网络</h1>
<h2 id="vnetwork-标准交换机">vNetwork 标准交换机</h2>

<p>虚机设置端口组，譬如DMZ、TestDev</p>

<p>需要配置连接虚机、主机、物理网卡的端口</p>

<p>企业增强版就有分布式交换机</p>

<h1 id="实验6">实验6</h1>

<h1 id="实验7">实验7</h1>
<p>VLAN设置</p>

<p>物理的VLAN的设置1-4096</p>

<p>虚拟化的VLAN的设置0-4095</p>

<h2 id="三种设置策略两种在内部一种在外部">三种设置策略，两种在内部，一种在外部</h2>

<p>	虚拟交换机打vlan标签</p>

<p>虚拟机端口组设置vlan，范围是1-4094</p>

<p>虚拟机打标签105vlan</p>

<p>	从虚机出来的包本身带vlanID，操作系统设置</p>

<p>Windows系统设置vlan标签</p>

<p>虚拟交换机的端口设置为4095</p>

<p>	在物理交换机上设置标签</p>

<p>端口组缺省为0</p>

<p>环境：全是生产机</p>

<p>配置标准虚拟交换机策略</p>

<h2 id="安全">安全</h2>

<p>	promisculus混杂模式</p>

<p>端口组启动混杂模式，进行抓包</p>

<p>	Mac策略更改模式</p>

<p>缺省可进可出</p>

<p>	Forged 传输</p>

<p>从外面来的，进</p>

<p>从虚机到物理网卡，出</p>

<p>流量调整策略
逻辑的调整，物理没法调整
标准交换机只能控制出栈方面的流量
负载平衡方法
	缺省策略
源端口 ID
	源 MAC hash
	Ip哈希
一个虚拟网卡可以对应多个物理网卡，需要做聚合
网络故障检测</p>

<p>实验注意事项
选择网卡1、3，不能选择2、3</p>

<p>两学员必须起名相同:Production.</p>
<h1 id="实验8">实验8</h1>

<h1 id="实验9">实验9</h1>

<h1 id="第六章-配置和管理虚拟存储">第六章 配置和管理虚拟存储</h1>
<h2 id="存储协议概述">存储协议概述</h2>

<p>支持裸设备 映射</p>

<p>把卷映射给虚机</p>

<p>同一个主机不存在vmotion</p>

<h2 id="数据存储">数据存储</h2>
<p>整个文件系统最大为64G</p>

<p>创建文件最大可以达到62G</p>

<p>小文件8k来存储</p>

<h2 id="配置软件-iscsi">配置软件 iSCSI</h2>
<p>配置 VMkernel 端口以访问 IP 存储</p>

<h1 id="实验9-1">实验9</h1>
<p>注意事项</p>

<p>最后一步，端口绑定不要做！</p>

<p>成功可以看到5个lan</p>

<p>尚未完成</p>

<p>FCoE 适配器</p>

<h1 id="实验10">实验10</h1>

<p>VMware vSphere VMFS 数据存储</p>

<p>一个学员用2个</p>

<p>3、4</p>

<h1 id="实验11">实验11</h1>
<p>Capacity   8.5GB</p>

<p>配置后：</p>

<p>Capacity   19.5GB</p>

<h1 id="第七章--虚拟机管理">第七章  虚拟机管理</h1>
<p>创建和克隆模板</p>

<p>虚机克隆模板</p>

<p>虚机转成模板</p>

<p>模板克隆模板</p>

<p>新的虚机生成</p>

<p>向导</p>

<p>导入</p>

<p>模板生成</p>

<p>虚机克隆</p>

<p>修改虚机</p>

<p>注意事项</p>

<p>千万不要点击  OK，再最下端进行修改属性</p>

<p>Lan第一个人做完，把他删掉；第二个人做完，把它删掉。</p>

<p>修改VMDK</p>

<p>模式的转换</p>

<p>迁移可以修改部署方式</p>

<p>精简变成全分配
Inflat
虚拟机选项
文件夹位置更改
做vmotion时候可以修改</p>

<p>迁移虚机
冷迁
挂起   实质关机
Vmotion    在线
Stoage  vmotion
Enhanced vMotion               主机存储一起迁
Vmotion迁移工作原理
vmotion网络进行迁移
vkernel port进行地址配置
在线迁内存</p>

<p>存储和主机通过网络路径迁移，不适用</p>
<h1 id="实验12">实验12</h1>

<h1 id="实验13">实验13</h1>
<p>C:1.99G
变化后
C:2.98G</p>

<h1 id="实验14">实验14</h1>
<p>迁移6次
创建虚拟机快照
能使用快照做备份
操作不敢保证严重后果，所以caozuo 之前做快照</p>

<p>磁盘状态变为只读</p>

<p>上端删除下端，删除
下端删除上端，合并
创建 vApp
资源池
实现资源的控制
定义开关机顺序、时间</p>
<h2 id="实验15">实验15</h2>
<p>Local-exi02</p>

<h1 id="实验16">实验16</h1>

<h1 id="第八章-数据保护">第八章 数据保护</h1>

<p>第九章 访问和身份验证控制
配置 ESXi 主机访问权限和身份验证
DCUI界面设置锁定模式
配置角色和权限
什么用户
什么组
具备什么角色进行操作
角色
特殊能力的打包
对象
同级相加、子集覆盖</p>
<h1 id="实验17">实验17</h1>
<h1 id="实验18">实验18</h1>

<h1 id="第十章-资源管理和监视">第十章 资源管理和监视</h1>
<p>虚拟 CPU 和内存概念
虚拟 SMP
对称多CPU
非一致性内存访问
CPU负载均衡
占用物理CPU方可使用
同时被占用</p>

<p>一个物理CPU   3-5虚拟cpu是合理的
内存
按需分配
分配按照page分配
资源控制
份额、限制和预留
三个参数
Eg：内存2G，当资源出现紧张，预留值500M，当启动时候，还是按照按需分配，资源紧张开始收紧内存，收到500M就停止。
份额：比例，权重。
资源池</p>

<h1 id="实验18-1">实验18</h1>

<p>监视资源使用情况
性能调整方法
原则一：CPU、存储数据一套数据，前后做比较
现象：网络慢
原则二：综合分析，虚拟机和主机都需要分析
虚拟化环境
Eg：虚拟机是否受 CPU 限制？
首先，看虚拟机性能图表
接着，看着主机性能图表</p>
<h1 id="实验19">实验19</h1>

<h2 id="第5课-使用警报">第5课 使用警报</h2>

<h1 id="实验20">实验20</h1>

<h1 id="实验21">实验21</h1>

<h1 id="第十一章-高可用性和容错">第十一章 高可用性和容错</h1>
<p>VMware 为每个级别提供保护 
组件高可用
网卡绑定
存储多路径
服务器
在线迁移
异常保护FT
HA保护
存储</p>

<p>数据
Vmdk复制到远程
站点
SRAM
vCenter Server 高可用
可以冷备
可以服务级别的高可用
应用程序的HA
高可用
99.999%
高可用的能力
监控主机，保护虚机
监控虚机，保护虚机
监控应用，保护应用
故障情况 – 主机
只有开启的虚机是受保护的
通过心跳监控
故障情况 – 客户操作系统
当虚拟机停止发 送心跳信号或虚 拟机进程崩溃时 (vmx)，vSphere HA 会重置虚拟机
故障情况 – 应用程序
重启虚机
需要安装 VMware Tools <br />
高可用体系结构
原理
主机的mosid号作为master，随机分配的
Master通过FDM告诉其他主机，利用心跳进行监控
Center怎么知道有多少虚机
通过maser写在所有共享存储上</p>

<p>网络心跳信号</p>

<p>Master需要两根心跳</p>

<p>出现故障的从属主机</p>

<p>虚机迁走</p>

<p>出现故障的主控主机</p>

<p>迁走并且重新选择master</p>

<p>隔离主机</p>

<p>看网络规划怎么设置</p>

<p>网络分区</p>

<p>脑裂</p>

<p>出现两个集群</p>

<p>一个班级分裂，那么配置一个临时班长</p>

<p>配置高可用</p>

<p>HA为集群的一个服务</p>

<p>接入控制</p>

<p>在三个虚机情况下，当启动第三个虚机时候，接入控制判断能不能启动，有木有资源支持启动</p>

<p>预留足够资源，满足此虚机出现问题，被其他虚机接管。</p>

<p>Eg：3个主机，3*4内存</p>

<p>动态算:所有开启虚机的CPU、内存的预留值的最大值来计算。</p>

<h1 id="实验21-1">实验21</h1>

<h1 id="实验22">实验22</h1>

<p>VSphere FT</p>

<p>虚机、内存两份，存储一份</p>

<p>主虚机接收IO请求，备虚机备份内存</p>

<h1 id="实验23">实验23</h1>

<p>Secondary Location</p>

<p>Joe01-2</p>

<p>vSphere Replication</p>

<p>保护开启虚机的VMDK</p>

<p>Vdp保护虚机</p>

<p>标准的OF模板</p>

<p>SVR的一个功能，独立出来的</p>

<h1 id="第十二章可扩展性">第十二章可扩展性</h1>
<p>HA</p>

<p>VC</p>

<p>DRS</p>

<p>不是时时刻刻起作用的</p>

<p>手动运行drs</p>

<p>EVC</p>

<p>提高虚拟机性能的方法</p>

<h1 id="实验24">实验24</h1>

<p>考试靠一半</p>

<p>题库</p>
<h1 id="第十三章-补丁程序管理">第十三章 补丁程序管理</h1>

<h1 id="第十四章--安装-vmware-组件">第十四章  安装 VMware 组件</h1>

<p>认证、授权以及评估</p>

<p>账号</p>

<p>账号：邮箱</p>

<p>证书</p>

<p>电子证书</p>

<p>无纸质</p>

<p>https://mylearn.vmware.com</p>

<p>点击登陆帮助</p>

<p>VCP5-TCV   DIANJI</p>

<p>四个账号</p>
 </div>
</article>
 </div>
</main>
<footer class="site-footer">
  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-3">
        <p>Copyrights  &copy; 2017. All Rights Reserved. </p>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
